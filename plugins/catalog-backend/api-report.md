## API Report File for "@backstage/plugin-catalog-backend"

> Do not edit this file. It is a report generated by [API Extractor](https://api-extractor.com/).

```ts
/// <reference types="node" />

import { AnalyzeLocationEntityField as AnalyzeLocationEntityField_2 } from '@backstage/plugin-catalog-common';
import { AnalyzeLocationExistingEntity as AnalyzeLocationExistingEntity_2 } from '@backstage/plugin-catalog-common';
import { AnalyzeLocationGenerateEntity as AnalyzeLocationGenerateEntity_2 } from '@backstage/plugin-catalog-common';
import { AnalyzeLocationRequest as AnalyzeLocationRequest_2 } from '@backstage/plugin-catalog-common';
import { AnalyzeLocationResponse as AnalyzeLocationResponse_2 } from '@backstage/plugin-catalog-common';
import { CatalogApi } from '@backstage/catalog-client';
import { CatalogEntityDocument } from '@backstage/plugin-catalog-common';
import { CatalogProcessor } from '@backstage/plugin-catalog-node';
import { CatalogProcessorCache } from '@backstage/plugin-catalog-node';
import { CatalogProcessorEmit } from '@backstage/plugin-catalog-node';
import { CatalogProcessorEntityResult } from '@backstage/plugin-catalog-node';
import { CatalogProcessorErrorResult } from '@backstage/plugin-catalog-node';
import { CatalogProcessorLocationResult } from '@backstage/plugin-catalog-node';
import { CatalogProcessorParser } from '@backstage/plugin-catalog-node';
import { CatalogProcessorRefreshKeysResult } from '@backstage/plugin-catalog-node';
import { CatalogProcessorRelationResult } from '@backstage/plugin-catalog-node';
import { CatalogProcessorResult } from '@backstage/plugin-catalog-node';
import { Config } from '@backstage/config';
import { DeferredEntity } from '@backstage/plugin-catalog-node';
import { DocumentCollatorFactory } from '@backstage/plugin-search-common';
import { Entity } from '@backstage/catalog-model';
import { EntityPolicy } from '@backstage/catalog-model';
import { EntityProvider } from '@backstage/plugin-catalog-node';
import { EntityProviderConnection } from '@backstage/plugin-catalog-node';
import { EntityProviderMutation } from '@backstage/plugin-catalog-node';
import { EntityRelationSpec } from '@backstage/plugin-catalog-node';
import { GetEntitiesRequest } from '@backstage/catalog-client';
import { JsonValue } from '@backstage/types';
import { LocationEntityV1alpha1 } from '@backstage/catalog-model';
import { LocationSpec as LocationSpec_2 } from '@backstage/plugin-catalog-common';
import { Logger } from 'winston';
import { Permission } from '@backstage/plugin-permission-common';
import { PermissionAuthorizer } from '@backstage/plugin-permission-common';
import { PermissionEvaluator } from '@backstage/plugin-permission-common';
import { PermissionRule } from '@backstage/plugin-permission-node';
import { PermissionRuleParams } from '@backstage/plugin-permission-common';
import { PluginDatabaseManager } from '@backstage/backend-common';
import { PluginEndpointDiscovery } from '@backstage/backend-common';
import { processingResult } from '@backstage/plugin-catalog-node';
import { Readable } from 'stream';
import { Router } from 'express';
import { ScmIntegrationRegistry } from '@backstage/integration';
import { TokenManager } from '@backstage/backend-common';
import { UrlReader } from '@backstage/backend-common';
import { Validators } from '@backstage/catalog-model';

// @public @deprecated
export type AnalyzeLocationEntityField = AnalyzeLocationEntityField_2;

// @public @deprecated
export type AnalyzeLocationExistingEntity = AnalyzeLocationExistingEntity_2;

// @public @deprecated
export type AnalyzeLocationGenerateEntity = AnalyzeLocationGenerateEntity_2;

// @public @deprecated (undocumented)
export type AnalyzeLocationRequest = AnalyzeLocationRequest_2;

// @public @deprecated (undocumented)
export type AnalyzeLocationResponse = AnalyzeLocationResponse_2;

// @public (undocumented)
export type AnalyzeOptions = {
  url: string;
  catalogFilename?: string;
};

// @public (undocumented)
export class AnnotateLocationEntityProcessor implements CatalogProcessor {
  constructor(options: { integrations: ScmIntegrationRegistry });
  // (undocumented)
  getProcessorName(): string;
  // (undocumented)
  preProcessEntity(
    entity: Entity,
    location: LocationSpec_2,
    _: CatalogProcessorEmit,
    originLocation: LocationSpec_2,
  ): Promise<Entity>;
}

// @public (undocumented)
export class AnnotateScmSlugEntityProcessor implements CatalogProcessor {
  constructor(opts: { scmIntegrationRegistry: ScmIntegrationRegistry });
  // (undocumented)
  static fromConfig(config: Config): AnnotateScmSlugEntityProcessor;
  // (undocumented)
  getProcessorName(): string;
  // (undocumented)
  preProcessEntity(entity: Entity, location: LocationSpec_2): Promise<Entity>;
}

// @public (undocumented)
export class BuiltinKindsEntityProcessor implements CatalogProcessor {
  // (undocumented)
  getProcessorName(): string;
  // (undocumented)
  postProcessEntity(
    entity: Entity,
    _location: LocationSpec_2,
    emit: CatalogProcessorEmit,
  ): Promise<Entity>;
  // (undocumented)
  validateEntityKind(entity: Entity): Promise<boolean>;
}

// @public
export class CatalogBuilder {
  addEntityPolicy(
    ...policies: Array<EntityPolicy | Array<EntityPolicy>>
  ): CatalogBuilder;
  addEntityProvider(
    ...providers: Array<EntityProvider | Array<EntityProvider>>
  ): CatalogBuilder;
  addLocationAnalyzers(
    ...analyzers: Array<ScmLocationAnalyzer | Array<ScmLocationAnalyzer>>
  ): CatalogBuilder;
  addPermissionRules(
    ...permissionRules: Array<
      CatalogPermissionRuleInput | Array<CatalogPermissionRuleInput>
    >
  ): this;
  addProcessor(
    ...processors: Array<CatalogProcessor | Array<CatalogProcessor>>
  ): CatalogBuilder;
  build(): Promise<{
    processingEngine: CatalogProcessingEngine;
    router: Router;
  }>;
  static create(env: CatalogEnvironment): CatalogBuilder;
  getDefaultProcessors(): CatalogProcessor[];
  replaceEntityPolicies(policies: EntityPolicy[]): CatalogBuilder;
  replaceProcessors(processors: CatalogProcessor[]): CatalogBuilder;
  setAllowedLocationTypes(allowedLocationTypes: string[]): CatalogBuilder;
  setEntityDataParser(parser: CatalogProcessorParser): CatalogBuilder;
  setFieldFormatValidators(validators: Partial<Validators>): CatalogBuilder;
  setLocationAnalyzer(locationAnalyzer: LocationAnalyzer): CatalogBuilder;
  setPlaceholderResolver(
    key: string,
    resolver: PlaceholderResolver,
  ): CatalogBuilder;
  setProcessingInterval(
    processingInterval: ProcessingIntervalFunction,
  ): CatalogBuilder;
  setProcessingIntervalSeconds(seconds: number): CatalogBuilder;
  // (undocumented)
  subscribe(options: {
    onProcessingError: (event: {
      unprocessedEntity: Entity;
      errors: Error[];
    }) => Promise<void> | void;
  }): void;
  useLegacySingleProcessorValidation(): this;
}

// @public (undocumented)
export type CatalogCollatorEntityTransformer = (
  entity: Entity,
) => Omit<CatalogEntityDocument, 'location' | 'authorization'>;

// @public (undocumented)
export type CatalogEnvironment = {
  logger: Logger;
  database: PluginDatabaseManager;
  config: Config;
  reader: UrlReader;
  permissions: PermissionEvaluator | PermissionAuthorizer;
};

// @public
export type CatalogPermissionRuleInput<
  TParams extends PermissionRuleParams = PermissionRuleParams,
> = PermissionRule<Entity, EntitiesSearchFilter, 'catalog-entity', TParams>;

// @public
export interface CatalogProcessingEngine {
  // (undocumented)
  start(): Promise<void>;
  // (undocumented)
  stop(): Promise<void>;
}

export { CatalogProcessor };

export { CatalogProcessorCache };

export { CatalogProcessorEmit };

export { CatalogProcessorEntityResult };

export { CatalogProcessorErrorResult };

export { CatalogProcessorLocationResult };

export { CatalogProcessorParser };

export { CatalogProcessorRefreshKeysResult };

export { CatalogProcessorRelationResult };

export { CatalogProcessorResult };

// @public (undocumented)
export class CodeOwnersProcessor implements CatalogProcessor {
  constructor(options: {
    integrations: ScmIntegrationRegistry;
    logger: Logger;
    reader: UrlReader;
  });
  // (undocumented)
  static fromConfig(
    config: Config,
    options: {
      logger: Logger;
      reader: UrlReader;
    },
  ): CodeOwnersProcessor;
  // (undocumented)
  getProcessorName(): string;
  // (undocumented)
  preProcessEntity(entity: Entity, location: LocationSpec_2): Promise<Entity>;
}

// @public
export function createRandomProcessingInterval(options: {
  minSeconds: number;
  maxSeconds: number;
}): ProcessingIntervalFunction;

// @public @deprecated (undocumented)
export class DefaultCatalogCollator {
  constructor(options: {
    discovery: PluginEndpointDiscovery;
    tokenManager: TokenManager;
    locationTemplate?: string;
    filter?: GetEntitiesRequest['filter'];
    catalogClient?: CatalogApi;
  });
  // (undocumented)
  protected applyArgsToFormat(
    format: string,
    args: Record<string, string>,
  ): string;
  // (undocumented)
  protected readonly catalogClient: CatalogApi;
  // (undocumented)
  protected discovery: PluginEndpointDiscovery;
  // (undocumented)
  execute(): Promise<CatalogEntityDocument[]>;
  // (undocumented)
  protected filter?: GetEntitiesRequest['filter'];
  // (undocumented)
  static fromConfig(
    _config: Config,
    options: {
      discovery: PluginEndpointDiscovery;
      tokenManager: TokenManager;
      filter?: GetEntitiesRequest['filter'];
    },
  ): DefaultCatalogCollator;
  // (undocumented)
  protected locationTemplate: string;
  // (undocumented)
  protected tokenManager: TokenManager;
  // (undocumented)
  readonly type: string;
  // (undocumented)
  readonly visibilityPermission: Permission;
}

// @public (undocumented)
export const defaultCatalogCollatorEntityTransformer: CatalogCollatorEntityTransformer;

// @public (undocumented)
export class DefaultCatalogCollatorFactory implements DocumentCollatorFactory {
  // (undocumented)
  static fromConfig(
    _config: Config,
    options: DefaultCatalogCollatorFactoryOptions,
  ): DefaultCatalogCollatorFactory;
  // (undocumented)
  getCollator(): Promise<Readable>;
  // (undocumented)
  readonly type = 'software-catalog';
  // (undocumented)
  readonly visibilityPermission: Permission;
}

// @public (undocumented)
export type DefaultCatalogCollatorFactoryOptions = {
  discovery: PluginEndpointDiscovery;
  tokenManager: TokenManager;
  locationTemplate?: string;
  filter?: GetEntitiesRequest['filter'];
  batchSize?: number;
  catalogClient?: CatalogApi;
  entityTransformer?: CatalogCollatorEntityTransformer;
};

export { DeferredEntity };

// @public
export type EntitiesSearchFilter = {
  key: string;
  values?: string[];
};

// @public
export type EntityFilter =
  | {
      allOf: EntityFilter[];
    }
  | {
      anyOf: EntityFilter[];
    }
  | {
      not: EntityFilter;
    }
  | EntitiesSearchFilter;

export { EntityProvider };

export { EntityProviderConnection };

export { EntityProviderMutation };

export { EntityRelationSpec };

// @public (undocumented)
export class FileReaderProcessor implements CatalogProcessor {
  // (undocumented)
  getProcessorName(): string;
  // (undocumented)
  readLocation(
    location: LocationSpec_2,
    optional: boolean,
    emit: CatalogProcessorEmit,
    parser: CatalogProcessorParser,
  ): Promise<boolean>;
}

// @public (undocumented)
export type LocationAnalyzer = {
  analyzeLocation(
    location: AnalyzeLocationRequest,
  ): Promise<AnalyzeLocationResponse>;
};

// @public (undocumented)
export class LocationEntityProcessor implements CatalogProcessor {
  constructor(options: LocationEntityProcessorOptions);
  // (undocumented)
  getProcessorName(): string;
  // (undocumented)
  postProcessEntity(
    entity: Entity,
    location: LocationSpec_2,
    emit: CatalogProcessorEmit,
  ): Promise<Entity>;
}

// @public (undocumented)
export type LocationEntityProcessorOptions = {
  integrations: ScmIntegrationRegistry;
};

// @public @deprecated
export type LocationSpec = LocationSpec_2;

// @public (undocumented)
export function locationSpecToLocationEntity(opts: {
  location: LocationSpec_2;
  parentEntity?: Entity;
}): LocationEntityV1alpha1;

// @public (undocumented)
export function parseEntityYaml(
  data: Buffer,
  location: LocationSpec_2,
): Iterable<CatalogProcessorResult>;

// @public
export class PlaceholderProcessor implements CatalogProcessor {
  constructor(options: PlaceholderProcessorOptions);
  // (undocumented)
  getProcessorName(): string;
  // (undocumented)
  preProcessEntity(
    entity: Entity,
    location: LocationSpec_2,
    emit: CatalogProcessorEmit,
  ): Promise<Entity>;
}

// @public (undocumented)
export type PlaceholderProcessorOptions = {
  resolvers: Record<string, PlaceholderResolver>;
  reader: UrlReader;
  integrations: ScmIntegrationRegistry;
};

// @public (undocumented)
export type PlaceholderResolver = (
  params: PlaceholderResolverParams,
) => Promise<JsonValue>;

// @public (undocumented)
export type PlaceholderResolverParams = {
  key: string;
  value: JsonValue;
  baseUrl: string;
  read: PlaceholderResolverRead;
  resolveUrl: PlaceholderResolverResolveUrl;
  emit: CatalogProcessorEmit;
};

// @public (undocumented)
export type PlaceholderResolverRead = (url: string) => Promise<Buffer>;

// @public (undocumented)
export type PlaceholderResolverResolveUrl = (
  url: string,
  base: string,
) => string;

// @public
export type ProcessingIntervalFunction = () => number;

export { processingResult };

// @public (undocumented)
export type ScmLocationAnalyzer = {
  supports(url: string): boolean;
  analyze(options: AnalyzeOptions): Promise<{
    existing: AnalyzeLocationExistingEntity[];
  }>;
};

// @public (undocumented)
export class UrlReaderProcessor implements CatalogProcessor {
  constructor(options: { reader: UrlReader; logger: Logger });
  // (undocumented)
  getProcessorName(): string;
  // (undocumented)
  readLocation(
    location: LocationSpec_2,
    optional: boolean,
    emit: CatalogProcessorEmit,
    parser: CatalogProcessorParser,
    cache: CatalogProcessorCache,
  ): Promise<boolean>;
}
```
